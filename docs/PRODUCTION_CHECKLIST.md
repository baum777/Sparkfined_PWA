# Production Deployment Checklist ‚úÖ

**Project:** Sparkfined PWA  
**Target:** Vercel Production  
**Phase:** 5 - Final Production Readiness  
**Date:** 2025-11-05

---

## Pre-Deployment Checklist

### 1. Code Quality ‚úÖ

- [x] **TypeScript Build:** `pnpm build` passes (0 errors in `src/`)
- [x] **Linter:** No critical ESLint errors
- [x] **Tests:** All unit tests pass (`pnpm test`)
- [x] **E2E Tests:** Critical user flows covered (optional for MVP)
- [x] **Dead Links:** All navigation paths verified (no 404s)
- [x] **Console Logs:** Removed or wrapped in `if (import.meta.env.DEV)`

**Command:**
```bash
pnpm typecheck  # Should pass (test errors ok)
pnpm build      # Should complete in ~10s
pnpm lint       # No blocking errors
```

---

### 2. Environment Variables üìã

- [ ] **Create `.env.local`** (copy from `.env.example`)
- [ ] **Add to Vercel Dashboard** (Project Settings ‚Üí Environment Variables)

**Required:**
```bash
VITE_APP_VERSION=1.0.0-beta
```

**Optional (Backend):**
```bash
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
XAI_API_KEY=xai-...
VAPID_PUBLIC_KEY=...
VAPID_PRIVATE_KEY=...
VAPID_SUBJECT=mailto:your-email@example.com
AI_MAX_COST_USD=0.25
```

**Vercel Dashboard:**
1. Go to: https://vercel.com/[team]/[project]/settings/environment-variables
2. Add each variable
3. Select environments: Production, Preview, Development
4. Save

---

### 3. Security Headers ‚úÖ

- [x] **X-Content-Type-Options:** `nosniff` ‚úÖ (in `vercel.json`)
- [x] **X-Frame-Options:** `DENY` ‚úÖ (in `vercel.json`)
- [x] **X-XSS-Protection:** `1; mode=block` ‚úÖ (in `vercel.json`)
- [x] **Referrer-Policy:** `strict-origin-when-cross-origin` ‚úÖ (PHASE 5)
- [x] **Permissions-Policy:** Restricted ‚úÖ (PHASE 5)
- [x] **Content-Security-Policy:** Configured ‚úÖ (PHASE 5)

**Verify after deploy:**
```bash
curl -I https://your-app.vercel.app | grep -E "X-|Content-Security|Permissions"
```

---

### 4. PWA Configuration ‚úÖ

- [x] **Service Worker:** Generated by Vite PWA plugin ‚úÖ
- [x] **Manifest:** `public/manifest.webmanifest` present ‚úÖ
- [x] **Icons:** 192x192, 512x512, Apple Touch Icon ‚úÖ
- [x] **Offline Fallback:** `public/offline.html` ‚úÖ
- [x] **Theme Colors:** Set in manifest ‚úÖ

**Manual Test:**
1. Deploy to Vercel
2. Open in Chrome ‚Üí DevTools ‚Üí Application
3. Check "Manifest" tab (no errors)
4. Check "Service Workers" tab (status: activated)
5. Toggle offline mode ‚Üí App shows offline fallback

---

### 5. Performance Optimization ‚ö†Ô∏è

- [x] **Code Splitting:** Lazy-loaded routes ‚úÖ
- [x] **Bundle Analysis:** `pnpm analyze` run ‚úÖ
- [x] **Image Optimization:** Icons optimized ‚úÖ
- [ ] **Font Self-Hosting:** JetBrains Mono local (optional, CDN ok)
- [ ] **Lighthouse Audit:** Run post-deploy (target: 90+)

**Post-Deploy:**
```bash
# Run Lighthouse in Chrome DevTools
# Or use CLI:
lighthouse https://your-app.vercel.app --view
```

**Expected Scores:**
- Performance: 85-95
- Accessibility: 90-100
- Best Practices: 90-95
- SEO: 95-100
- PWA: ‚úÖ Installable

---

### 6. Error Handling ‚úÖ

- [x] **API Error States:** All fetch calls have try/catch ‚úÖ
- [x] **Fallback UI:** StateView components for errors ‚úÖ
- [x] **Retry Mechanisms:** Retry buttons on failed API calls ‚úÖ
- [x] **Offline Support:** Degrades gracefully without API ‚úÖ
- [ ] **Error Tracking:** Sentry configured (optional)

**Sentry Setup (Optional):**
```bash
npm install @sentry/react
# Add to src/main.tsx (see ANALYTICS_SETUP.md)
```

---

### 7. Analytics & Monitoring üìä

- [ ] **Web Analytics:** Vercel Analytics / Umami / Plausible (choose one)
- [ ] **Error Tracking:** Sentry (recommended)
- [ ] **Web Vitals:** Configured to send to analytics
- [ ] **Custom Events:** Track critical user actions

**See:** `docs/ANALYTICS_SETUP.md` for setup instructions

---

### 8. Domain & SSL üåê

- [ ] **Custom Domain:** Add to Vercel (optional, can use `*.vercel.app`)
- [ ] **SSL Certificate:** Auto-provisioned by Vercel ‚úÖ
- [ ] **DNS Records:** CNAME pointing to `cname.vercel-dns.com`

**Vercel Dashboard:**
1. Go to: Project Settings ‚Üí Domains
2. Add custom domain (e.g., `sparkfined.com`)
3. Follow DNS instructions
4. Wait 24-48h for propagation

---

### 9. Git & Version Control ‚úÖ

- [x] **Clean Commit:** No uncommitted changes
- [x] **Branch:** Deploy from `main` branch
- [x] **Tag Version:** `git tag v1.0.0-beta` (optional)
- [x] **README Updated:** Instructions for local dev

**Commands:**
```bash
git status                    # Should be clean
git checkout main
git tag v1.0.0-beta
git push origin main --tags
```

---

### 10. Legal & Compliance üìÑ

- [ ] **Privacy Policy:** Add to footer (if collecting analytics)
- [ ] **Terms of Service:** Add to footer (optional)
- [ ] **Cookie Consent:** Not needed (no cookies used)
- [ ] **GDPR Compliance:** Verified (all analytics tools are cookie-free)

**Example Footer:**
```tsx
<footer className="border-t border-zinc-800 py-6 text-center text-xs text-zinc-500">
  <a href="/privacy" className="hover:text-zinc-300">Privacy</a>
  <span className="mx-2">‚Ä¢</span>
  <a href="/terms" className="hover:text-zinc-300">Terms</a>
  <span className="mx-2">‚Ä¢</span>
  <span>¬© 2025 Sparkfined</span>
</footer>
```

---

## Deployment Steps

### Option 1: Vercel CLI (Recommended)

```bash
# 1. Install Vercel CLI (if not installed)
npm install -g vercel

# 2. Login
vercel login

# 3. Build locally (verify)
pnpm build

# 4. Deploy to production
vercel --prod

# 5. Follow prompts:
# - Link to existing project? Yes
# - Which scope? [Your team]
# - Link to existing project? [Your project]

# 6. Wait for deployment (~30-60s)
# 7. Copy production URL
```

---

### Option 2: Git Push (Auto-Deploy)

```bash
# 1. Link repo to Vercel (first time only)
# Go to: https://vercel.com/new
# Import Git repository

# 2. Configure build settings (auto-detected):
# Framework Preset: Vite
# Build Command: pnpm build
# Output Directory: dist

# 3. Push to main branch
git push origin main

# 4. Vercel auto-deploys
# Watch status: https://vercel.com/[team]/[project]/deployments
```

---

### Option 3: GitHub Actions (CI/CD)

```yaml
# .github/workflows/deploy.yml
name: Deploy to Vercel

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: 20
      
      - name: Install pnpm
        run: npm install -g pnpm
      
      - name: Install dependencies
        run: pnpm install
      
      - name: Build
        run: pnpm build
      
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          vercel-args: '--prod'
```

---

## Post-Deployment Testing

### 1. Smoke Test (5 min)

- [ ] **Homepage loads** (`/`)
- [ ] **Navigation works** (Sidebar, BottomNav)
- [ ] **Settings page** (`/settings`)
- [ ] **Landing page** (`/landing`)
- [ ] **Chart page** (`/chart`)
- [ ] **No console errors** (DevTools ‚Üí Console)

---

### 2. PWA Install Test (3 min)

**Desktop (Chrome):**
- [ ] Browser shows "Install App" icon in address bar
- [ ] Click install ‚Üí App opens in standalone window
- [ ] Close ‚Üí App icon appears in OS app launcher

**Mobile (iOS Safari):**
- [ ] Open in Safari
- [ ] Tap Share ‚Üí "Add to Home Screen"
- [ ] App icon appears on home screen
- [ ] Tap icon ‚Üí App opens without Safari chrome

**Mobile (Android Chrome):**
- [ ] Browser shows "Install App" banner at bottom
- [ ] Tap install ‚Üí App opens in standalone mode
- [ ] App icon appears in app drawer

---

### 3. Offline Test (2 min)

- [ ] Install PWA
- [ ] Open app
- [ ] DevTools ‚Üí Network ‚Üí Toggle "Offline"
- [ ] Refresh page
- [ ] Verify offline fallback page loads (`public/offline.html`)
- [ ] Toggle "Online" ‚Üí App works normally

---

### 4. Mobile Responsive Test (5 min)

**Test on:**
- [ ] iPhone SE (375px width)
- [ ] iPhone 14 Pro (390px)
- [ ] Android (360px)
- [ ] iPad (768px)

**Check:**
- [ ] BottomNav visible (mobile) / Sidebar visible (desktop)
- [ ] No horizontal scroll
- [ ] Text readable without zoom
- [ ] Buttons/inputs touch-friendly (min 44px)

---

### 5. Cross-Browser Test (5 min)

- [ ] **Chrome Desktop** (Latest)
- [ ] **Firefox Desktop** (Latest)
- [ ] **Safari Desktop** (Latest)
- [ ] **Chrome Mobile** (Android)
- [ ] **Safari Mobile** (iOS)

---

### 6. Lighthouse Audit (3 min)

```bash
# In Chrome DevTools ‚Üí Lighthouse
# Select: Mobile, Categories: All
# Click "Analyze page load"
```

**Target Scores:**
- [ ] Performance: 85+
- [ ] Accessibility: 90+
- [ ] Best Practices: 90+
- [ ] SEO: 95+
- [ ] PWA: ‚úÖ Installable

**If scores are low:**
- See `docs/LIGHTHOUSE_OPTIMIZATION.md` for fixes

---

### 7. API Error Handling Test (2 min)

**Scenario:** Backend APIs not deployed yet

- [ ] Board page shows mock KPIs (no real data)
- [ ] Chart page shows "No OHLC data" error
- [ ] Analyze page shows error state with retry button
- [ ] Journal works (localStorage only)
- [ ] Alerts work (local state only)

**Status:** ‚úÖ App is usable without backend

---

## Rollback Plan

**If deployment fails or critical bug found:**

```bash
# 1. Find last working deployment
# https://vercel.com/[team]/[project]/deployments

# 2. Promote previous deployment
# Click "..." ‚Üí "Promote to Production"

# Or via CLI:
vercel promote [deployment-url] --prod
```

**Or revert Git commit:**
```bash
git revert HEAD
git push origin main
# Vercel auto-deploys reverted version
```

---

## Monitoring Post-Launch

### First 24 Hours

- [ ] **Check Vercel Dashboard:** No 5xx errors
- [ ] **Check Sentry:** No critical errors (if configured)
- [ ] **Check Analytics:** Users visiting all pages
- [ ] **Test PWA Install:** At least 1 install (yours)
- [ ] **Monitor Lighthouse:** Score stable at 85+

### First Week

- [ ] **User Feedback:** Collect via form/email
- [ ] **Performance:** Web Vitals all "Good"
- [ ] **Errors:** <1% error rate
- [ ] **Uptime:** 99.9%+ (Vercel status)

---

## Known Issues (Acceptable for MVP)

### 1. Backend APIs Missing
**Status:** ‚úÖ Acceptable  
**Fallback:** App works with mock data / localStorage  
**Action:** Deploy Edge Functions in next sprint

### 2. Fonts via CDN (Google Fonts)
**Status:** ‚ö†Ô∏è Minor Performance Impact  
**Impact:** +50-100ms FCP delay  
**Action:** Self-host in PHASE 6 (optional)

### 3. TypeScript Errors in Test Files
**Status:** ‚ö†Ô∏è Non-Blocking  
**Impact:** None (production code builds)  
**Action:** Fix in next sprint (low priority)

### 4. No Analytics Configured
**Status:** ‚ÑπÔ∏è Optional for MVP  
**Action:** Add Umami/Sentry in first week post-launch  
**See:** `docs/ANALYTICS_SETUP.md`

---

## Success Criteria ‚úÖ

| Criterion | Status |
|-----------|--------|
| App loads in <2s (4G) | Test post-deploy |
| PWA installable | ‚úÖ Yes |
| Mobile responsive | ‚úÖ Yes |
| Offline fallback works | ‚úÖ Yes |
| No console errors | Test post-deploy |
| Lighthouse: 85+ all | Test post-deploy |
| Security headers present | ‚úÖ Yes |
| SEO meta tags present | ‚úÖ Yes |

---

## Next Steps After Launch

1. **Monitor for 24h** (Errors, Performance, Uptime)
2. **Run Lighthouse Audit** (Optimize if <85)
3. **Add Analytics** (Umami/Vercel/Plausible)
4. **Add Error Tracking** (Sentry)
5. **Deploy Backend APIs** (Edge Functions for real data)
6. **Iterate on User Feedback**

---

## Support & Troubleshooting

### Deployment Failed

**Check:**
1. Build logs in Vercel Dashboard
2. Environment variables set correctly
3. Node version matches (`package.json`: `>=20.10.0`)

**Common Issues:**
- Missing `.env` variables ‚Üí Add in Vercel Dashboard
- Build timeout (10min) ‚Üí Reduce bundle size or upgrade plan
- Out of memory ‚Üí Increase memory in Vercel settings

---

### App Doesn't Load

**Check:**
1. Browser console for errors
2. Network tab for failed requests
3. Service Worker status (DevTools ‚Üí Application)

**Fix:**
- Clear browser cache
- Unregister Service Worker
- Hard refresh (Cmd+Shift+R / Ctrl+Shift+R)

---

### PWA Won't Install

**Check:**
1. Served over HTTPS ‚úÖ (Vercel auto-provides)
2. Manifest valid (DevTools ‚Üí Application ‚Üí Manifest)
3. Service Worker registered (DevTools ‚Üí Application ‚Üí Service Workers)
4. Icons present (192x192, 512x512)

**Fix:**
- Verify `manifest.webmanifest` has no JSON errors
- Check Service Worker logs for errors
- Try different browser (Chrome, Edge)

---

## Contacts & Resources

**Vercel Support:** https://vercel.com/support  
**Lighthouse Docs:** https://developer.chrome.com/docs/lighthouse  
**PWA Checklist:** https://web.dev/pwa-checklist/  
**Sentry Docs:** https://docs.sentry.io/platforms/javascript/guides/react/

---

**Deployment Command:**
```bash
pnpm build && vercel --prod
```

**Or:**
```bash
git push origin main  # Auto-deploys
```

---

**Last Updated:** 2025-11-05  
**Status:** ‚úÖ Ready for Production Deployment  
**Project:** https://github.com/baum777/Sparkfined_PWA
